# macOS Keychain

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** ЁЯТм [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) рдПрдХ **рдбрд╛рд░реНрдХ-рд╡реЗрдм** рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╕рд░реНрдЪ рдЗрдВрдЬрди рд╣реИ рдЬреЛ **рдореБрдлреНрдд** рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдпрд╣ рдЬрд╛рдВрдЪрд╛ рдЬрд╛ рд╕рдХреЗ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдХрдВрдкрдиреА рдпрд╛ рдЗрд╕рдХреЗ рдЧреНрд░рд╛рд╣рдХ **рд╕реБрд░рдХреНрд╖рд┐рдд** рд╣реИрдВ рдпрд╛ рдирд╣реАрдВ **рдЪреЛрд░реА рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдорд╛рд▓рд╡реЗрдпрд░** рджреНрд╡рд╛рд░рд╛ред

WhiteIntel рдХрд╛ рдкреНрд░рд╛рдердорд┐рдХ рд▓рдХреНрд╖реНрдп рдЬрд╛рдирдХрд╛рд░реА рдЪреБрд░рд╛рдиреЗ рд╡рд╛рд▓реЗ рдорд╛рд▓рд╡реЗрдпрд░ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдЦрд╛рддрд╛ рдЕрдзрд┐рдЧреНрд░рд╣рдг рдФрд░ рд░реИрдирд╕рдорд╡реЗрдпрд░ рд╣рдорд▓реЛрдВ рд╕реЗ рд▓рдбрд╝рдирд╛ рд╣реИред

рдЖрдк рдЙрдирдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рдкрд░ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдореБрдлреНрдд** рдореЗрдВ рдЙрдирдХреЗ рдЗрдВрдЬрди рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% embed url="https://whiteintel.io" %}

***

## рдореБрдЦреНрдп рдХреАрдЪреЗрди

* **рдпреВрдЬрд░ рдХреАрдЪреЗрди** (`~/Library/Keychains/login.keycahin-db`), рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдЬреИрд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд╛рд╕рд╡рд░реНрдб, рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд╛рд╕рд╡рд░реНрдб, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдирд┐рд░реНрдорд┐рдд рдкреНрд░рдорд╛рдгрдкрддреНрд░, рдиреЗрдЯрд╡рд░реНрдХ рдкрд╛рд╕рд╡рд░реНрдб, рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдирд┐рд░реНрдорд┐рдд рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ/рдирд┐рдЬреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
* **рд╕рд┐рд╕реНрдЯрдо рдХреАрдЪреЗрди** (`/Library/Keychains/System.keychain`), рдЬреЛ **рд╕рд┐рд╕реНрдЯрдо-рд╡реНрдпрд╛рдкреА рдХреНрд░реЗрдбреЗрдВрд╢рд┐рдпрд▓реНрд╕** рдЬреИрд╕реЗ WiFi рдкрд╛рд╕рд╡рд░реНрдб, рд╕рд┐рд╕реНрдЯрдо рд░реВрдЯ рдкреНрд░рдорд╛рдгрдкрддреНрд░, рд╕рд┐рд╕реНрдЯрдо рдирд┐рдЬреА рдХреБрдВрдЬрд┐рдпрд╛рдБ, рдФрд░ рд╕рд┐рд╕реНрдЯрдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИред

### рдкрд╛рд╕рд╡рд░реНрдб рдХреАрдЪреЗрди рдПрдХреНрд╕реЗрд╕

рдпреЗ рдлрд╝рд╛рдЗрд▓реЗрдВ, рдЬрдмрдХрд┐ рдЗрдирдореЗрдВ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╕реБрд░рдХреНрд╖рд╛ рдирд╣реАрдВ рд╣реИ рдФрд░ рдЗрдиреНрд╣реЗрдВ **рдбрд╛рдЙрдирд▓реЛрдб** рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╣реИрдВ рдФрд░ рдЗрдиреНрд╣реЗрдВ **рдбрд┐рдХреНрд░рд┐рдкреНрдЯ** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП **рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ рдкрд╛рд╕рд╡рд░реНрдб** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдбрд┐рдХреНрд░рд┐рдкреНрд╢рди рдХреЗ рд▓рд┐рдП [**Chainbreaker**](https://github.com/n0fate/chainbreaker) рдЬреИрд╕реЗ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

## рдХреАрдЪреЗрди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рд╕реБрд░рдХреНрд╖рд╛

### ACLs

рдХреАрдЪреЗрди рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ **рдПрдХреНрд╕реЗрд╕ рдХрдВрдЯреНрд░реЛрд▓ рд╕реВрдЪрд┐рдпреЛрдВ (ACLs)** рджреНрд╡рд╛рд░рд╛ рд╢рд╛рд╕рд┐рдд рд╣реЛрддреА рд╣реИ рдЬреЛ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдХреМрди рдХреАрдЪреЗрди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдкрд░ рд╡рд┐рднрд┐рдиреНрди рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ:

* **ACLAuhtorizationExportClear**: рдзрд╛рд░рдХ рдХреЛ рд░рд╣рд╕реНрдп рдХрд╛ рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* **ACLAuhtorizationExportWrapped**: рдзрд╛рд░рдХ рдХреЛ рджреВрд╕рд░реЗ рдкреНрд░рджрд╛рди рдХрд┐рдП рдЧрдП рдкрд╛рд╕рд╡рд░реНрдб рдХреЗ рд╕рд╛рде рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рд╕реНрдкрд╖реНрдЯ рдкрд╛рда рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред
* **ACLAuhtorizationAny**: рдзрд╛рд░рдХ рдХреЛ рдХреЛрдИ рднреА рдХреНрд░рд┐рдпрд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

ACLs рдХреЗ рд╕рд╛рде рдПрдХ **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреА рд╕реВрдЪреА** рд╣реЛрддреА рд╣реИ рдЬреЛ рдмрд┐рдирд╛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЗ рдпреЗ рдХреНрд░рд┐рдпрд╛рдПрдБ рдХрд░ рд╕рдХрддреА рд╣реИрдВред рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:

* **N`il`** (рдХреЛрдИ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ, **рд╕рднреА рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реИрдВ**)
* рдПрдХ **рдЦрд╛рд▓реА** рд╕реВрдЪреА (**рдХреЛрдИ рднреА** рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдирд╣реАрдВ рд╣реИ)
* **рд╡рд┐рд╢рд┐рд╖реНрдЯ** **рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ** рдХреА **рд╕реВрдЪреА**ред

рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдореЗрдВ рдХреБрдВрдЬреА **`ACLAuthorizationPartitionID`** рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ **teamid, apple,** рдФрд░ **cdhash** рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред

* рдпрджрд┐ **teamid** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ, рддреЛ **рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐** рдорд╛рди **рдмрд┐рдирд╛** **рдкреНрд░реЙрдореНрдкреНрдЯ** рдХреЗ **рдПрдХреНрд╕реЗрд╕** рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХрд╛ **рд╕рдорд╛рди teamid** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред
* рдпрджрд┐ **apple** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ, рддреЛ рдРрдк рдХреЛ **Apple** рджреНрд╡рд╛рд░рд╛ **рд╕рд╛рдЗрди** рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред
* рдпрджрд┐ **cdhash** рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╣реИ, рддреЛ **рдРрдк** рдХреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ **cdhash** рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред

### рдХреАрдЪреЗрди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрдирд╛рдирд╛

рдЬрдм **`Keychain Access.app`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ **рдирдпрд╛** **рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐** рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ, рддреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдирд┐рдпрдо рд▓рд╛рдЧреВ рд╣реЛрддреЗ рд╣реИрдВ:

* рд╕рднреА рдРрдкреНрд╕ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* **рдХреЛрдИ рдРрдкреНрд╕** рдирд┐рд░реНрдпрд╛рдд/рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХрд┐рдП рдмрд┐рдирд╛)ред
* рд╕рднреА рдРрдкреНрд╕ рдЗрдВрдЯреАрдЧреНрд░рд┐рдЯреА рдЪреЗрдХ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* рдХреЛрдИ рдРрдкреНрд╕ ACLs рдХреЛ рдирд╣реАрдВ рдмрджрд▓ рд╕рдХрддреЗред
* **partitionID** рдХреЛ **`apple`** рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

рдЬрдм рдПрдХ **рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреАрдЪреЗрди рдореЗрдВ рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрдирд╛рддрд╛ рд╣реИ**, рддреЛ рдирд┐рдпрдо рдереЛрдбрд╝реЗ рдЕрд▓рдЧ рд╣реЛрддреЗ рд╣реИрдВ:

* рд╕рднреА рдРрдкреНрд╕ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред
* рдХреЗрд╡рд▓ **рдмрдирд╛рдиреЗ рд╡рд╛рд▓рд╛ рдЕрдиреБрдкреНрд░рдпреЛрдЧ** (рдпрд╛ рдХреЛрдИ рдЕрдиреНрдп рдРрдкреНрд╕ рдЬреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЬреЛрдбрд╝реЗ рдЧрдП рд╣реИрдВ) рдирд┐рд░реНрдпрд╛рдд/рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ (рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХрд┐рдП рдмрд┐рдирд╛)ред
* рд╕рднреА рдРрдкреНрд╕ рдЗрдВрдЯреАрдЧреНрд░рд┐рдЯреА рдЪреЗрдХ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред
* рдХреЛрдИ рдРрдкреНрд╕ ACLs рдХреЛ рдирд╣реАрдВ рдмрджрд▓ рд╕рдХрддреЗред
* **partitionID** рдХреЛ **`teamid:[teamID here]`** рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред

## рдХреАрдЪреЗрди рддрдХ рдкрд╣реБрдБрдЪ

### `security`
```bash
# List keychains
security list-keychains

# Dump all metadata and decrypted secrets (a lot of pop-ups)
security dump-keychain -a -d

# Find generic password for the "Slack" account and print the secrets
security find-generic-password -a "Slack" -g

# Change the specified entrys PartitionID entry
security set-generic-password-parition-list -s "test service" -a "test acount" -S

# Dump specifically the user keychain
security dump-keychain ~/Library/Keychains/login.keychain-db
```
### APIs

{% hint style="success" %}
**рдХреАрдЪреЗрди рдПрдиреНрдпреВрдорд░реЗрд╢рди рдФрд░ рд╕реАрдХреНрд░реЗрдЯреНрд╕ рдХрд╛ рдбрдВрдкрд┐рдВрдЧ** рдЬреЛ **рдкреНрд░реЙрдореНрдкреНрдЯ рдирд╣реАрдВ рдЬрдирд░реЗрдЯ рдХрд░реЗрдЧрд╛** рдЙрд╕реЗ [**LockSmith**](https://github.com/its-a-feature/LockSmith) рдЯреВрд▓ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

рдкреНрд░рддреНрдпреЗрдХ рдХреАрдЪреЗрди рдПрдВрдЯреНрд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ **рдЬрд╛рдирдХрд╛рд░реА** рд╕реВрдЪреАрдмрджреНрдз рдХрд░реЗрдВ рдФрд░ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

* API **`SecItemCopyMatching`** рдкреНрд░рддреНрдпреЗрдХ рдПрдВрдЯреНрд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдХреБрдЫ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ рд╕реЗрдЯ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВ:
* **`kSecReturnData`**: рдпрджрд┐ рд╕рддреНрдп рд╣реИ, рддреЛ рдпрд╣ рдбреЗрдЯрд╛ рдХреЛ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдЧрд╛ (рд╕рдВрднрд╛рд╡рд┐рдд рдкреЙрдк-рдЕрдк рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдЧрд▓рдд рд╕реЗрдЯ рдХрд░реЗрдВ)
* **`kSecReturnRef`**: рдХреАрдЪреЗрди рдЖрдЗрдЯрдо рдХрд╛ рд╕рдВрджрд░реНрдн рднреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ (рдпрджрд┐ рдмрд╛рдж рдореЗрдВ рдЖрдк рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рдЖрдк рдмрд┐рдирд╛ рдкреЙрдк-рдЕрдк рдХреЗ рдбрд┐рдХреНрд░рд┐рдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рддреЛ рдЗрд╕реЗ рд╕рддреНрдп рдкрд░ рд╕реЗрдЯ рдХрд░реЗрдВ)
* **`kSecReturnAttributes`**: рдПрдВрдЯреНрд░реАрдЬрд╝ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореЗрдЯрд╛рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ
* **`kSecMatchLimit`**: рдХрд┐рддрдиреЗ рдкрд░рд┐рдгрд╛рдо рд▓реМрдЯрд╛рдиреЗ рд╣реИрдВ
* **`kSecClass`**: рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдХреАрдЪреЗрди рдПрдВрдЯреНрд░реА

рдкреНрд░рддреНрдпреЗрдХ рдПрдВрдЯреНрд░реА рдХреЗ **ACLs** рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ:

* API **`SecAccessCopyACLList`** рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЖрдк **рдХреАрдЪреЗрди рдЖрдЗрдЯрдо рдХреЗ рд▓рд┐рдП ACL** рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдпрд╣ ACLs рдХреА рдПрдХ рд╕реВрдЪреА рд▓реМрдЯрд╛рдПрдЧрд╛ (рдЬреИрд╕реЗ `ACLAuhtorizationExportClear` рдФрд░ рдЕрдиреНрдп рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦрд┐рдд) рдЬрд╣рд╛рдБ рдкреНрд░рддреНрдпреЗрдХ рд╕реВрдЪреА рдореЗрдВ:
* рд╡рд┐рд╡рд░рдг
* **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реВрдЪреА**ред рдпрд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:
* рдПрдХ рдРрдк: /Applications/Slack.app
* рдПрдХ рдмрд╛рдЗрдирд░реА: /usr/libexec/airportd
* рдПрдХ рд╕рдореВрд╣: group://AirPort

рдбреЗрдЯрд╛ рдирд┐рд░реНрдпрд╛рдд рдХрд░реЗрдВ:

* API **`SecKeychainItemCopyContent`** рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ
* API **`SecItemExport`** рдХреБрдВрдЬреА рдФрд░ рдкреНрд░рдорд╛рдгрдкрддреНрд░реЛрдВ рдХреЛ рдирд┐рд░реНрдпрд╛рдд рдХрд░рддрд╛ рд╣реИ рд▓реЗрдХрд┐рди рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ

рдФрд░ рдпреЗ рд╣реИрдВ **рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдБ** рддрд╛рдХрд┐ рдЖрдк **рдмрд┐рдирд╛ рдкреНрд░реЙрдореНрдкреНрдЯ рдХреЗ рдПрдХ рд╕реАрдХреНрд░реЗрдЯ рдирд┐рд░реНрдпрд╛рдд рдХрд░ рд╕рдХреЗрдВ**:

* рдпрджрд┐ **1+ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп** рдРрдкреНрд╕ рд╕реВрдЪреАрдмрджреНрдз рд╣реИрдВ:
* рдЙрдЪрд┐рдд **рдЕрдзрд┐рдХрд╛рд░** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (**`Nil`**, рдпрд╛ рд╕реАрдХреНрд░реЗрдЯ рдЬрд╛рдирдХрд╛рд░реА рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдорддрд┐ рд╕реВрдЪреА рдореЗрдВ **рднрд╛рдЧ** рд╣реЛрдирд╛)
* **PartitionID** рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ
* рдПрдХ **рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдРрдк** рдХрд╛ рдХреЛрдб рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдореЗрд▓ рдЦрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рдпрд╛ рд╕рд╣реА KeychainAccessGroup рдХрд╛ рд╕рджрд╕реНрдп рд╣реЛрдирд╛)
* рдпрджрд┐ **рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп** рд╣реИрдВ:
* рдЙрдЪрд┐рдд **рдЕрдзрд┐рдХрд╛рд░** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ
* **PartitionID** рд╕реЗ рдореЗрд▓ рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рд╕рд┐рдЧреНрдиреЗрдЪрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ
* рдпрджрд┐ **рдХреЛрдИ PartitionID рдирд╣реАрдВ рд╣реИ**, рддреЛ рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ

{% hint style="danger" %}
рдЗрд╕рд▓рд┐рдП, рдпрджрд┐ **1 рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реВрдЪреАрдмрджреНрдз рд╣реИ**, рддреЛ рдЖрдкрдХреЛ **рдЙрд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдХреЛрдб рдЗрдВрдЬреЗрдХреНрдЯ рдХрд░рдиреЗ** рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред

рдпрджрд┐ **apple** **partitionID** рдореЗрдВ рдЗрдВрдЧрд┐рдд рд╣реИ, рддреЛ рдЖрдк рдЗрд╕реЗ **`osascript`** рдХреЗ рд╕рд╛рде рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЗрд╕рд▓рд┐рдП рдХреБрдЫ рднреА рдЬреЛ partitionID рдореЗрдВ apple рдХреЗ рд╕рд╛рде рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рдиреЛрдВ рдкрд░ рднрд░реЛрд╕рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИред рдЗрд╕рдХреЗ рд▓рд┐рдП **`Python`** рдХрд╛ рднреА рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред
{% endhint %}

### Two additional attributes

* **рдЕрджреГрд╢реНрдп**: рдпрд╣ **UI** рдХреАрдЪреЗрди рдРрдк рд╕реЗ рдПрдВрдЯреНрд░реА рдХреЛ **рдЫрд┐рдкрд╛рдиреЗ** рдХреЗ рд▓рд┐рдП рдПрдХ рдмреВрд▓рд┐рдпрди рдлреНрд▓реИрдЧ рд╣реИ
* **рд╕рд╛рдорд╛рдиреНрдп**: рдпрд╣ **рдореЗрдЯрд╛рдбреЗрдЯрд╛** рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ (рдЗрд╕рд▓рд┐рдП рдпрд╣ рдПрдиреНрдХреНрд░рд┐рдкреНрдЯреЗрдб рдирд╣реАрдВ рд╣реИ)
* Microsoft рд╕рднреА рд░рд┐рдлреНрд░реЗрд╢ рдЯреЛрдХрди рдХреЛ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдПрдВрдбрдкреЙрдЗрдВрдЯ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд▓реЗрди рдЯреЗрдХреНрд╕реНрдЯ рдореЗрдВ рд╕реНрдЯреЛрд░ рдХрд░ рд░рд╣рд╛ рдерд╛ред

## References

* [**#OBTS v5.0: "Lock Picking the macOS Keychain" - Cody Thomas**](https://www.youtube.com/watch?v=jKE1ZW33JpY)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) рдПрдХ **рдбрд╛рд░реНрдХ-рд╡реЗрдм** рджреНрд╡рд╛рд░рд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд рд╕рд░реНрдЪ рдЗрдВрдЬрди рд╣реИ рдЬреЛ рдпрд╣ рдЬрд╛рдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП **рдореБрдлреНрдд** рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛рдПрдБ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдХреЛрдИ рдХрдВрдкрдиреА рдпрд╛ рдЙрд╕рдХреЗ рдЧреНрд░рд╛рд╣рдХ **рд╕реНрдЯреАрд▓рд░ рдореИрд▓рд╡реЗрдпрд░** рджреНрд╡рд╛рд░рд╛ **рд╕рдордЭреМрддрд╛** рдХрд┐рдП рдЧрдП рд╣реИрдВред

WhiteIntel рдХрд╛ рдкреНрд░рд╛рдердорд┐рдХ рд▓рдХреНрд╖реНрдп рдЬрд╛рдирдХрд╛рд░реА-рдЪреЛрд░реА рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдореИрд▓рд╡реЗрдпрд░ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдЕрдХрд╛рдЙрдВрдЯ рдЯреЗрдХрдУрд╡рд░ рдФрд░ рд░реИрдирд╕рдорд╡реЗрдпрд░ рд╣рдорд▓реЛрдВ рд╕реЗ рд▓рдбрд╝рдирд╛ рд╣реИред

рдЖрдк рдЙрдирдХреА рд╡реЗрдмрд╕рд╛рдЗрдЯ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ **рдореБрдлреНрдд** рдореЗрдВ рдЙрдирдХреЗ рдЗрдВрдЬрди рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ:

{% embed url="https://whiteintel.io" %}

{% hint style="success" %}
AWS рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ:<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../../.gitbook/assets/arte.png" alt="" data-size="line">\
GCP рд╣реИрдХрд┐рдВрдЧ рд╕реАрдЦреЗрдВ рдФрд░ рдЕрднреНрдпрд╛рд╕ рдХрд░реЗрдВ: <img src="../../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВ</summary>

* [**рд╕рджрд╕реНрдпрддрд╛ рдпреЛрдЬрдирд╛рдПрдБ**](https://github.com/sponsors/carlospolop) рджреЗрдЦреЗрдВ!
* **ЁЯТм [**Discord рд╕рдореВрд╣**](https://discord.gg/hRep4RUj7f) рдпрд╛ [**рдЯреЗрд▓реАрдЧреНрд░рд╛рдо рд╕рдореВрд╣**](https://t.me/peass) рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдВ рдпрд╛ **Twitter** рдкрд░ рд╣рдореЗрдВ **рдлреЙрд▓реЛ** рдХрд░реЗрдВ ЁЯРж [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **рд╣реИрдХрд┐рдВрдЧ рдЯреНрд░рд┐рдХреНрд╕ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ рдФрд░** [**HackTricks**](https://github.com/carlospolop/hacktricks) рдФрд░ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) рдЧрд┐рдЯрд╣рдм рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА рдореЗрдВ PRs рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВред

</details>
{% endhint %}
