# 2FA/MFA/OTP Bypass

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuatilie** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ni injini ya utafutaji inayotumiwa na **dark-web** ambayo inatoa kazi za **bure** kuangalia ikiwa kampuni au wateja wake wamekuwa **compromised** na **stealer malwares**.

Lengo lao kuu la WhiteIntel ni kupambana na kuchukuliwa kwa akaunti na mashambulizi ya ransomware yanayotokana na malware inayochukua taarifa.

Unaweza kuangalia tovuti yao na kujaribu injini yao **bure** kwenye:

{% embed url="https://whiteintel.io" %}

***

## **Mbinu za Kubadilisha Uthibitisho wa Mbili**

### **Upatikanaji wa Kituo Moja kwa Moja**

Ili kupita 2FA, pata kituo kinachofuata moja kwa moja, kujua njia ni muhimu. Ikiwa haifanikiwi, badilisha **Referrer header** ili kuiga urambazaji kutoka kwenye ukurasa wa uthibitisho wa 2FA.

### **Matumizi ya Tokeni Zilizotumika Tangu Awali**

Kurejelea tokeni zilizotumika awali kwa uthibitisho ndani ya akaunti kunaweza kuwa na ufanisi.

### **Matumizi ya Tokeni Zisizotumika**

Kuchota tokeni kutoka kwenye akaunti yako mwenyewe ili kupita 2FA kwenye akaunti nyingine kunaweza kujaribiwa.

### **Ufunuo wa Tokeni**

Chunguza ikiwa tokeni imefunuliwa katika jibu kutoka kwa programu ya wavuti.

### **Kunyanyua Kiungo cha Uthibitisho**

Kutumia **kiungo cha uthibitisho wa barua pepe kilichotumwa wakati wa kuunda akaunti** kunaweza kuruhusu upatikanaji wa wasifu bila 2FA, kama ilivyoangaziwa katika [post](https://srahulceh.medium.com/behind-the-scenes-of-a-security-bug-the-perils-of-2fa-cookie-generation-496d9519771b).

### **Manipulation ya Kikao**

Kuanza vikao kwa akaunti ya mtumiaji na ya mwathirika, na kukamilisha 2FA kwa akaunti ya mtumiaji bila kuendelea, kunaweza kuruhusu jaribio la kufikia hatua inayofuata katika mtiririko wa akaunti ya mwathirika, ikitumia mapungufu ya usimamizi wa kikao cha nyuma.

### **Mekaniki ya Kurekebisha Nenosiri**

Kuchunguza kazi ya kurekebisha nenosiri, ambayo inamwingiza mtumiaji kwenye programu baada ya kurekebisha, kwa uwezo wake wa kuruhusu marekebisho mengi kwa kutumia kiungo kimoja ni muhimu. Kuingia na taarifa mpya za kurekebisha kunaweza kupita 2FA.

### **Kuvunjika kwa Jukwaa la OAuth**

Kuvunja akaunti ya mtumiaji kwenye jukwaa la **OAuth** lililoaminika (mfano, Google, Facebook) kunaweza kutoa njia ya kupita 2FA.

### **Mashambulizi ya Brute Force**

#### **Ukosefu wa Kiwango cha Kiwango**

Ukosefu wa kikomo kwenye idadi ya majaribio ya msimbo unaruhusu mashambulizi ya brute force, ingawa ukomo wa kimya unapaswa kuzingatiwa.

#### **Brute Force Polepole**

Shambulio la brute force polepole linaweza kufanyika ambapo mipaka ya mtiririko ipo bila kikomo cha jumla.

#### **Kurejesha Kiwango cha Kutuma Msimbo**

Kurejesha msimbo kunarejesha kiwango cha kiwango, kuruhusu majaribio ya kuendelea ya brute force.

#### **Kukwepa Kiwango cha Kiwango cha Mteja**

Hati inaelezea mbinu za kukwepa kiwango cha kiwango cha mteja.

#### **Vitendo vya Ndani Havina Kiwango cha Kiwango**

Mipaka ya kiwango inaweza kulinda majaribio ya kuingia lakini si vitendo vya ndani vya akaunti.

#### **Gharama za Kurejesha Msimbo wa SMS**

Kurejesha msimbo kupita kiasi kupitia SMS kunagharimu kampuni, ingawa hakupitishi 2FA.

#### **Uundaji wa OTP Usio na Mwisho**

Uundaji wa OTP usio na mwisho kwa kutumia misimbo rahisi unaruhusu brute force kwa kujaribu seti ndogo ya misimbo.

### **Kuvunja Masharti ya Mbio**

Kuvunja masharti ya mbio kwa kupita 2FA kunaweza kupatikana katika hati maalum.

### **Vulnerabilities za CSRF/Clickjacking**

Kuchunguza vulnerabilities za CSRF au Clickjacking ili kuzima 2FA ni mkakati unaoweza kutekelezeka.

### **Matumizi ya Kipengele cha "Nikumbuke"**

#### **Thamani za Keki Zinazoweza Kutarajiwa**

Kukisia thamani ya keki ya "nikumbuke" kunaweza kupita vizuizi.

#### **Uigaji wa Anwani ya IP**

Kuingiza anwani ya IP ya mwathirika kupitia **X-Forwarded-For** header kunaweza kupita vizuizi.

### **Matumizi ya Matoleo ya Kale**

#### **Subdomains**

Kujaribu subdomains kunaweza kutumia matoleo ya zamani yasiyo na msaada wa 2FA au kuwa na utekelezaji dhaifu wa 2FA.

#### **API Endpoints**

Matoleo ya zamani ya API, yanayoonyeshwa na /v\*/ njia za saraka, yanaweza kuwa na hatari kwa mbinu za kupita 2FA.

### **Kushughulikia Vikao vya Awali**

Kumaliza vikao vilivyopo wakati wa kuanzishwa kwa 2FA kunalinda akaunti dhidi ya upatikanaji usioidhinishwa kutoka kwa vikao vilivyovunjika.

### **Mapungufu ya Udhibiti wa Upatikanaji na Nambari za Akiba**

Uundaji wa haraka na uwezekano wa kupata nambari za akiba bila idhini mara tu 2FA inapoanzishwa, hasa na mipangilio ya CORS isiyo sahihi/vulnerabilities za XSS, kuna hatari.

### **Ufunuo wa Taarifa kwenye Ukurasa wa 2FA**

Ufunuo wa taarifa nyeti (mfano, nambari ya simu) kwenye ukurasa wa uthibitisho wa 2FA ni wasiwasi.

### **Kurekebisha Nenosiri Kukatisha 2FA**

Mchakato unaoonyesha njia inayoweza kupita unajumuisha uundaji wa akaunti, kuanzishwa kwa 2FA, kurekebisha nenosiri, na kuingia baadaye bila hitaji la 2FA.

### **Maombi ya Kijakazi**

Kutumia maombi ya kijakazi ili kuficha majaribio ya brute force au kupotosha mifumo ya kiwango cha kiwango kunaongeza safu nyingine kwa mikakati ya kupita. Kuunda maombi kama haya kunahitaji uelewa wa kina wa hatua za usalama za programu na tabia za kiwango cha kiwango.

### Makosa ya Ujenzi wa OTP

Ikiwa OTP inaundwa kwa msingi wa data ambayo mtumiaji tayari ana au ambayo inatumwa kabla ya kuunda OTP, inawezekana kwa mtumiaji pia kuunda na kupita.

## Marejeleo

* [https://medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35](https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/%22https:/medium.com/@iSecMax/two-factor-authentication-security-testing-and-possible-bypasses-f65650412b35%22/README.md)
* [https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718](https://azwi.medium.com/2-factor-authentication-bypass-3b2bbd907718)
* [https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116\_1d0f6ce59992222b0812b7cab19a4bce](https://getpocket.com/read/aM7dap2bTo21bg6fRDAV2c5thng5T48b3f0Pd1geW2u186eafibdXj7aA78Ip116\_1d0f6ce59992222b0812b7cab19a4bce)

### [WhiteIntel](https://whiteintel.io)

<figure><img src="../.gitbook/assets/image (1227).png" alt=""><figcaption></figcaption></figure>

[**WhiteIntel**](https://whiteintel.io) ni injini ya utafutaji inayotumiwa na **dark-web** ambayo inatoa kazi za **bure** kuangalia ikiwa kampuni au wateja wake wamekuwa **compromised** na **stealer malwares**.

Lengo lao kuu la WhiteIntel ni kupambana na kuchukuliwa kwa akaunti na mashambulizi ya ransomware yanayotokana na malware inayochukua taarifa.

Unaweza kuangalia tovuti yao na kujaribu injini yao **bure** kwenye:

{% embed url="https://whiteintel.io" %}

P

{% hint style="success" %}
Jifunze na fanya mazoezi ya AWS Hacking:<img src="../.gitbook/assets/arte.png" alt="" data-size="line">[**HackTricks Training AWS Red Team Expert (ARTE)**](https://training.hacktricks.xyz/courses/arte)<img src="../.gitbook/assets/arte.png" alt="" data-size="line">\
Jifunze na fanya mazoezi ya GCP Hacking: <img src="../.gitbook/assets/grte.png" alt="" data-size="line">[**HackTricks Training GCP Red Team Expert (GRTE)**<img src="../.gitbook/assets/grte.png" alt="" data-size="line">](https://training.hacktricks.xyz/courses/grte)

<details>

<summary>Support HackTricks</summary>

* Angalia [**mpango wa usajili**](https://github.com/sponsors/carlospolop)!
* **Jiunge na** üí¨ [**kikundi cha Discord**](https://discord.gg/hRep4RUj7f) au [**kikundi cha telegram**](https://t.me/peass) au **tufuatilie** kwenye **Twitter** üê¶ [**@hacktricks\_live**](https://twitter.com/hacktricks\_live)**.**
* **Shiriki mbinu za udukuzi kwa kuwasilisha PRs kwa** [**HackTricks**](https://github.com/carlospolop/hacktricks) na [**HackTricks Cloud**](https://github.com/carlospolop/hacktricks-cloud) repos za github.

</details>
{% endhint %}
